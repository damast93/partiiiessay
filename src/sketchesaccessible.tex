\section{Models are accessible}
\label{sec:sketchesaccessible}

The goal of this section is the remaining direction in the sketchability theorem: To show that $\mod(\mathbb S)$ is accessible for every sketch $\mathbb S$. \\

As an outline, let's look at the following crude proof that the category of groups is $\aleph_1$-accessible. For every infinite regular cardinal $\kappa$, every group $G$ of cardinality less than $\kappa$ is $\kappa$-presentable by \ref{prop:varietypresentable}, because we have a presentation of $G$ by its own elements and multiplication table
\[ G \cong \langle e_g : g \in G \,|\, e_g e_h = e_{gh} \rangle. \]

Every group is the colimit (union) of its subgroups of cardinality less than $\kappa$, because the subgroups generated by each singleton element are at most countable and thus among them. So representatives of these groups up to isomorphism would be a candidate generating set in the definition of accessibility. Write $\sub_\kappa(G)$ for the poset of subgroups of cardinality less than $\kappa$. It remains to find out when this poset is actually $\kappa$-directed. \\

It is certainly not the case for $\kappa=\aleph_0$. Consider the infinite group $G=\langle a, b \,|\, a^2 = b^2 = 1 \rangle$ and the poset of its \emph{finite} subgroups. Then the subgroups $\langle a \rangle$ and $\langle b \rangle$ don't have an upper bound. 
However for $\kappa > \aleph_0$, if $\{H_i\}$ is a family of less than $\kappa$ subgroups of cardinality less than $\kappa$, the set \[ A = \bigcup_i H_i \]
is still smaller than $\kappa$ by regularity. The subgroup $\langle A \rangle$ generated by it has at most as many elements as there are words in $A \cup A^{-1}$, thus
\begin{equation} |\langle A \rangle| \leq 2 \cdot |A|\cdot \aleph_0 < \kappa. \label{eq:skolembound} \end{equation}
Therefore $\sub_\kappa(G)$ is $\kappa$-directed. $\blacksquare$ \\

We'll give an analogous argument for the models of a sketch $\mathbb S$. The hard part will obtaining the bound on the size of ``generated submodels'' like \eqref{eq:skolembound}. The rather explicit construction of the generated subgroup is a special case of the classical Skolem hull-construction in model theory, which builds up a model by inductively including all witnesses for existential formulae. This leads to a formulation of the (infinitary) downward Löwenheim-Skolem theorem for models of sketches. \\

First some terminology:

% Sort the S/A notation out; maybe fix a sketch S
\begin{Definition}
Let $M : \cat S \to \catname{Set}$ be a model of a sketch $\mathbb S$ and $S = \obj(\cat S)$. We will think of $M$ as an $S$-sorted set endowed with unary perations and write $s_M$ for the set $M(s)$ as well as $f_M : s_M \to s'_M$ for $M(f)$ if $f : s \to s'$ is a morphism in $\cat S$.
\begin{enumerate}
\item We define the cardinality of an $S$-sorted set $A$ to be \[ |A| = \sum_s |s_A|. \]
\item Subsets and submodels $B \subseteq A$ and other set-theoretic notions like unions will be considered sort-by-sort.
\item We call a (many-sorted) set $A$ $\lambda$-small if $|A|<\lambda$.
\end{enumerate}
\end{Definition}

\begin{Theorem}[Downward Löwenheim-Skolem for Sketches]\label{thm:ls}
Let $\mathbb S$ be a sketch. Then there is a regular cardinal $\kappa > \mu_{\mathbb S}$, such that for every model $M \in \mod(\mathbb S)$ the following holds: Every subset $A \subseteq M$ of cardinality less than $\kappa$ is contained in a submodel $\bar A \subseteq M$ of cardinality less than $\kappa$.
\end{Theorem}
We'll prove the theorem in the next subsection and describe the cardinal $\kappa$ explicitly. % Quote from logic, attempt to prove \\

\begin{Theorem}
$\mod(\mathbb S)$ is $\kappa$-accessible for every sketch $\mathbb S$.
\end{Theorem}
\begin{Proof}
We take $\kappa > \mu_\mathbb S$ to be the cardinal from \ref{thm:ls}.
\begin{enumerate}
\item Recall from \ref{prop:modsdirectedcolimits} that $\mod(\mathbb S)$ is closed under $\kappa$-directed colimits, computed sort-by-sort.
\item Every $\kappa$-small model is $\kappa$-presentable. We show that this is true in general for $\fun{\cat S}{\catname{Set}}$, so the same has to hold in the full subcategory $\mod(\mathbb S)$ that computes the same relevant colimits: \\

Let $F : \cat S \to \catname{Set}$ be $\kappa$-small. We know that $F$ is the canonical colimit of representable functors, which are finitely presentable objects by \ref{ex:representablepresentable}. When we can show the bound $|\el(F)| < \kappa$ for the canonical diagram, by \ref{prop:smallcolim}, $F$ will be $\kappa$-presentable. [$|\cat C|$ denotes the cardinality of the set of morphisms of $C$. ]

The morphisms of the canonical diagram $\el(F)$ all have the form $(s,x) \xrightarrow{f} (t,y)$ where
\[ x \in F(s),\, y \in F(t),\, h : s \to t,\, x, y \in S. \]
The number of such morphisms is bounded by
\[ |\el(F)| \leq |F|^2 \cdot |S|^3 = |F|\cdot |S| < \kappa. \]

\item For every model $M$, write $\sub_\kappa(M)$ for the poset of its $\kappa$-small submodels ordered by inclusion. By the Löwenheim-Skolem theorem, this poset is $\kappa$-directed, because if $\{A_i\}$ is a $\kappa$-small family of such submodels, the set
\[ A = \bigcup_i A_i \]
has cardinality smaller than $\kappa$, so $A$ is contained in a submodel from $\sub_\kappa(M)$.

\item $M$ is the $\kappa$-directed colimit (union) of $\sub_\kappa(M)$, as this colimit is computed set-theoretically and again by Löwenheim-Skolem, every singleton from the underlying set of $M$ is contained in a submodel from $\sub_\kappa(M)$. 

\item The class of all $\mathbb S$-models of cardinality less than $\kappa$ is essentially small. Their representatives form a generating set of $\mod(\mathbb S)$ in the definition of $\kappa$-accessibility.
\end{enumerate}
\end{Proof}

\begin{Corollary}
Locally presentable categories are precisely the model categories of limit sketches.
\end{Corollary}
\begin{Proof}
It remains to show that $\mod(\mathbb S)$ is locally presentable for limit sketches $\mathbb S$. But $\mod(\mathbb S)$ is closed under limits in $\fun{\cat A}{\catname{Set}}$ as limits are computed pointwise and limits commute with limits. Therefore it is complete and accessible, thus locally presentable.
\end{Proof}

\subsection{The Löwenheim-Skolem theorem}

I will motivate the cardinal bounds that occur in the infinitary version of Löwenheim-Skolem and then adapt the theorem to models of sketches. \\

Consider a $\lambda$-ary algebra $M$ with $\mu$ operations and a subset $A_0 \subseteq M$. We close $A_0$ under the operations of the algebra by the following transfinite process:

\[
\begin{cases}
A_{i+1} = A_i^+, \\
A_{\alpha} = \cup_{i < \alpha}\,A_i
\end{cases}
\]

where

\[ A^+ = \{ f(\vec a) : \vec a \in A^\nu \, | \, f \text{ operation of arity } \nu \}. \] 

For convenience, we assume that $M$ has an identity operation among it, so $A \subseteq A^+$. The process stabilises at $A_\lambda$, for if $\vec a \in (A_\lambda)^\nu, \nu < \lambda$, each component $a_i$ lies in some $A_{\alpha_i}$. By regularity of $\lambda$, the supremum $\alpha$ of the $\alpha_i$ is $< \lambda$, thus already $\vec a \in (A_\alpha)^\nu$ and $f(\vec a) \in A_{\alpha+1} \subseteq A_\lambda$ by construction. $A_\lambda$ is the smallest subalgebra containing $A$. \\

Because all operations of the algebra have arity $< \lambda$, the set of possible inputs $\vec a$ ranges over the set
\[ A^{< \lambda} := \bigsqcup_{\nu < \lambda} A^\nu. \]

We use the following notation for the cardinality of that set
\begin{Definition}
For a cardinal $\mu$, let
\[ \mu^{< \lambda} := \sum_{\nu < \lambda} \mu^\nu. \]
\end{Definition}

The cardinality of $A^+$ is thus bounded by
\[ |A^+| \leq |\{ (f,\vec a) : \vec a \in A^{< \lambda} \}| = \mu \cdot |A|^{< \lambda}. \]

Just as a finite sequence of finite sequences can be compressed into a single finite sequence, the impact of repeated applications can be easily bounded by the following lemma:

\begin{Lemma}
For $\mu \geq \lambda$ and $\lambda$ regular, 
\[ \left(\mu^{< \lambda}\right)^{< \lambda} = \mu^{< \lambda}. \]
\end{Lemma}
\begin{Proof}
We have $(\mu^{< \lambda})^\alpha = \mu^{< \lambda}$ for all $\alpha < \lambda$. A function $\alpha \to \mu^{< \lambda}$ is equivalent to giving a function $c : \alpha \to \mathfrak L$ where $\mathfrak L$ is the set of cardinals $< \lambda$ and for each $i< \alpha$ an element of $\mu^{c(i)}$. Therefore 
\begin{align*}
(\mu^{< \lambda})^\alpha = \sum_{c : \alpha \to \mathfrak L} \prod_{i < \alpha} \mu^{c(i)} 
= \sum_{c : \alpha \to \mathfrak L} \mu^{\sum_{i < \alpha} c(i)}
\end{align*}
Now $|\mathfrak L^\alpha| \leq \lambda^\alpha \leq \mu^{< \lambda}$ and by regularity, $\sum_{i < \alpha} c(i) < \lambda$, thus the whole sum is bounded by $\mu^{< \lambda}$. Therefore we get
\[ (\mu^{< \lambda})^{< \lambda} = \sum_{\alpha < \lambda} (\mu^{< \lambda})^\alpha \leq \mu^{< \lambda}. \]
\end{Proof}

As a corollary, we can compute the bound \eqref{eq:skolembound} for the $\lambda$-ary algebra: Let $\beta \geq \mu + \lambda$ and say $|A_0| \leq \beta^{< \lambda}$, then we'll show inductively that $|A_i| \leq \beta^{< \lambda}$ for all $i \leq \lambda$.
\begin{description}
\item[Successor step] If $|A_i| \leq \beta^{< \lambda}$, then
\[ |A_i^+| = \mu \cdot |A_i|^{< \lambda} \leq \left(\beta^{< \lambda}\right)^{< \lambda} = \beta^{< \lambda}. \]
\item[Limit step] If $|A_i| \leq \beta^{< \lambda}$ for each $i < \alpha \leq \lambda$ then
\[ |A_\alpha| \leq \sum_{i < \alpha} |A_i| \leq \beta^{< \lambda} \]
by regularity.
\end{description}

We can use the same closure process for models of a sum-sketch $\mathbb S$. This is because by \ref{prop:sumconnectedlimits}, intersections of submodels are still submodels, therefore the description of the ``generated submodel'' stays the same as for varieties.
\begin{Proposition}
Let $\mathbb S = (\cat S, \dist L, \dist C)$ be a sum sketch. Take the regular cardinals $\lambda = \lambda^+_\mathbb S, \mu = (\lambda + \mu_\mathbb S)^+$ and $\kappa = (\mu^{< \lambda})^+$. Then every subset $A$ of cardinality $< \kappa$ of a model of $\mathbb S$ is contained in a submodel of cardinality $< \kappa$.
\end{Proposition}
\begin{Proof}
Let $M$ be a model of $\mathbb S$ and $A \subseteq M$ a subset. A is a submodel of $M$ if and only if the following three closure conditions hold
\begin{enumerate}
\item\label{item:f} for every $f : s \to t$ and $a \in s_A$, $f_M(a) \in t_A$
\item\label{item:cones} for every distinguished cone $(s \xrightarrow{\pi_i} s_i)$, we have $a \in s_A$ iff $(\pi_i)_M(a) \in (s_i)_A$ for all $i$.
\item\label{item:cocones} for every distinguished cocone $(s_i \xrightarrow{c_i} s)$, we have $a \in (s_i)_A$ iff $(c_i)_M(a) \in s_A$ for some $i$.
\end{enumerate}
This leads to the following closure process: We define $A^+$ as the union of the following elements
\begin{enumerate}
\item $f_M(a)$ where $f : s \to t$, $a \in A$
\item $a \in s_M$ such that $(\pi_i)_M(a) = a_i$ where $(a_i \in (s_i)_A)$ is a compatible collection with respect to a distinguished cone $(s \xrightarrow{\pi_i} s_i)$
\item $a \in (s_i)_M$ where $b \in s_A, (c_i)_M(a) = b$ for a distinguished cocone  $(s_i \xrightarrow{c_i} s)$
\end{enumerate}
This process stabilises for $A_\lambda$ with the smallest submodel containing $A$. We show again by induction that $|A_i| < \kappa$ for all $i \leq \lambda$: 
\begin{description}
\item[Successor step] Let $|A_i|$ be $< \kappa$. The contributions of \ref{item:f} and \ref{item:cocones} are easily bounded $< \kappa$. The contribution of \ref{item:cones} is at most $|\dist L|\cdot |A_i|^{< \lambda}$. But $|A_i| \leq \mu^{< \lambda}$ by assumption, so \[ |A_i|^{< \lambda} \leq \left(\mu^{< \lambda}\right)^{< \lambda} = \mu^{< \lambda} < \kappa. \]
\item[Limit step] follows by regularity of $\kappa$.
\end{description}
\end{Proof}

The final step of the proof of Löwenheim-Skolem is to generalise the result for sum sketches to arbitrary sketches: \\

Every colimit specification in a sketch can be formulated using only coproducts and coequalisers. By a technique called Morleyisation, we can even restrict ourselves to coproducts and \emph{effective coequalisers} (\emph{regular epi specifications}). Those are distinguished coequaliser cocones of the form
\[
\xymatrix{
a \ar@/^/[r]^{f_1} \ar@/_/[r]_{f_2} & b \ar[r]^{g} & c
}\]
where at the same time $(f_1,f_2)$ is specified as a kernel pair (pullback) cone of $c$. We call a sketch coherent if every cocone is either discrete or a an effective coequaliser cocone. \\ % Make Morley more precise, coherent?!'

We want to show that we can drop the effective coequaliser specifications and use our result for the remaining sum sketch. The idea is that in $\catname{Set}$, given a map and its kernel pair, stating it is effective (coequaliser of the kernel pair) just requires stating that is surjective. Furthermore in $\catname{Set}$, every epimorphism splits. We create a new sketch $\mathbb S'$ by adding to every effective coequaliser specification a splitting morphism
\[
\xymatrix{
a \ar@/^/[r]^{f_1} \ar@/_/[r]_{f_2} & b \ar[r]^{g} & c \ar@/^/[l]^{r}
}\]
together with the condition $g \cdot r = \id_c$. Let $\mathbb S''$ be the sketch $\mathbb S'$ with all effective coequaliser specifications removed. \\

Given a model $M \in \mod(\mathbb S)$ and $A \subseteq M$, we obtain a model $M'$ of $\mathbb S'$ by choosing appropriate splittings. As described above, we can identify the models of $\mathbb S'$ and $\mathbb S''$ as the kernel pairs are enough to determine the coequalisers given surjectivity. However $\mathbb S''$ is a sum sketch, so we can apply the closure process to $A$. The generated submodel will be a submodel of $M$ by forgetting the splittings.